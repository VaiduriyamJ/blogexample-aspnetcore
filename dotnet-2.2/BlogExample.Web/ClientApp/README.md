TODO:
- Figure out sub-state stuff
- wire container